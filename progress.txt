feature-006: Cargo Workspace Restructuring - Phase 1: Core Crate Extraction
============================================================================

## Status: COMPLETE

## Summary

Successfully converted desktop/src-tauri/ from a monolithic single crate into a Cargo
workspace and extracted the core traits module into a standalone `plan-cascade-core` crate.

## Stories Completed

### Story 1: Create workspace Cargo.toml and core crate skeleton [DONE]
- Converted desktop/src-tauri/Cargo.toml to a workspace with [workspace] section
- Created desktop/src-tauri/crates/core/ with its own Cargo.toml
- Core crate depends only on: serde, serde_json, async-trait, thiserror (+ tokio dev-dep)
- Main app crate depends on plan-cascade-core via path dependency

### Story 2: Move core module contents into the core crate [DONE]
- Extracted to plan-cascade-core crate:
  - error.rs: CoreError, CoreResult (mirror of AppError without DB/keyring variants)
  - context.rs: ExecutionContext trait, ToolContext, OrchestratorContext
  - tool_trait.rs: ToolDefinitionTrait, ToolExecutable, UnifiedTool, UnifiedToolRegistry
  - builders.rs: AgentConfigBuilder, ExecutionConfigBuilder, QualityGateConfigBuilder, SessionState, SessionStateKey
- Kept in main crate (cross-service dependencies):
  - adapter.rs: Bridges core traits with existing Tool/ToolRegistry (depends on tools, llm types)
  - compaction.rs: Context compaction strategies (depends on llm::types::Message)
  - event_actions.rs: Event + Actions pattern (depends on agent_composer::types::AgentEvent)
- Updated services/core/mod.rs to re-export from plan-cascade-core for backward compatibility
- Updated utils/error.rs with From<CoreError> for AppError conversion
- Converted adapter.rs imports from AppResult/AppError to CoreResult/CoreError where needed
- Converted import_from_legacy inherent method to free function import_legacy_tools()

### Story 3: Verify compilation and run tests [DONE]
- cargo check -p plan-cascade-core: PASSES (clean)
- cargo check --lib (main app crate): PASSES (warnings only, no errors)
- cargo test -p plan-cascade-core: 81 tests pass
- cargo test -p plan-cascade-desktop --lib -- services::core: 77 tests pass
- cargo test -p plan-cascade-desktop --lib -- services::orchestrator::event_actions_applicator: 23 tests pass
- All 2883 main crate tests pass (9 pre-existing failures unrelated to our changes)

## Dependency Graph

```
plan-cascade-core (zero workspace dependencies)
  ├── serde, serde_json
  ├── async-trait
  └── thiserror

plan-cascade-desktop (app crate)
  ├── plan-cascade-core (path = "crates/core")
  ├── tauri, tauri-plugin-*
  ├── rusqlite, keyring
  └── ... (all other deps)
```

## Files Changed

### New Files
- desktop/src-tauri/crates/core/Cargo.toml
- desktop/src-tauri/crates/core/src/lib.rs
- desktop/src-tauri/crates/core/src/error.rs
- desktop/src-tauri/crates/core/src/context.rs
- desktop/src-tauri/crates/core/src/tool_trait.rs
- desktop/src-tauri/crates/core/src/builders.rs

### Modified Files
- desktop/src-tauri/Cargo.toml (added [workspace], added plan-cascade-core dep)
- desktop/src-tauri/src/services/core/mod.rs (re-exports from plan-cascade-core)
- desktop/src-tauri/src/services/core/adapter.rs (updated imports, CoreResult/CoreError)
- desktop/src-tauri/src/services/core/compaction.rs (updated imports, CoreResult/CoreError)
- desktop/src-tauri/src/utils/error.rs (added From<CoreError> for AppError)

### Removed Files
- desktop/src-tauri/src/services/core/context.rs (moved to core crate)
- desktop/src-tauri/src/services/core/tool_trait.rs (moved to core crate)
- desktop/src-tauri/src/services/core/builders.rs (moved to core crate)

## FEATURE_COMPLETE
## MEGA_PROGRESS: feature-006 DONE
